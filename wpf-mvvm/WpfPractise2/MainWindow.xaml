<Window x:Class="WpfPractise2.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Segmented Sieve Demo" Height="560" Width="760">
    <Grid Margin="16">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <!-- MENÜ -->
            <RowDefinition Height="Auto"/>
            <!-- Parametreler -->
            <RowDefinition Height="Auto"/>
            <!-- Komutlar -->
            <RowDefinition Height="*"/>
            <!-- DataGrid -->
            <RowDefinition Height="Auto"/>
            <!-- Alt bar -->
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="2*"/>
            <ColumnDefinition Width="2*"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- ===== ÜST MENÜ ===== -->
        <Menu Grid.Row="0" Grid.ColumnSpan="3" Margin="0,-14,0,14">
            <MenuItem Header="_Dosya">
                <MenuItem Header="_Çıkış" Click="Exit_Click" ToolTip="Uygulamadan çık"/>
            </MenuItem>

            <MenuItem Header="_Ayarlar" ToolTip="Uygulama tercihleri">
                <!-- Odak Modu: IsCheckable + TwoWay binding -->
                <MenuItem Header="_Odak Modu" IsCheckable="True"
                          IsChecked="{Binding FocusModeEnabled, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                          ToolTip="Açıkken: Aktif pencere dışındakiler simge durumuna küçülür; kapanınca bir önceki pencere öne gelir."/>
            </MenuItem>

            <MenuItem Header="_Araçlar">
                <MenuItem Header="_Asal Ara" Click="OpenSearch_Click" InputGestureText="Ctrl+F"
                          ToolTip="Arama penceresini aç"/>
            </MenuItem>
        </Menu>

        <!-- Üst satır: parametreler -->
        <StackPanel Grid.Row="1" Grid.ColumnSpan="3" Orientation="Horizontal">
            <StackPanel Orientation="Horizontal" Margin="0,0,12,0">
                <TextBlock Text="Üst Sınır:" VerticalAlignment="Center"/>
                <TextBox Width="140" Margin="6,0,0,0"
                         Text="{Binding UpperLimit, UpdateSourceTrigger=PropertyChanged}"/>
            </StackPanel>

            <StackPanel Orientation="Horizontal" Margin="0,0,12,0">
                <TextBlock Text="Segment Boyutu:" VerticalAlignment="Center"/>
                <TextBox Width="140" Margin="6,0,0,0"
                         Text="{Binding SegmentSize, UpdateSourceTrigger=PropertyChanged}"/>
            </StackPanel>

            <CheckBox Content="Liste Listesi Topla (Bellek Kullanır)"
                      IsChecked="{Binding CollectPrimes}"
                      VerticalAlignment="Center"/>
        </StackPanel>

        <!-- Komutlar -->
        <StackPanel Grid.Row="2" Grid.ColumnSpan="3" Orientation="Horizontal" Margin="0,12,0,12">
            <Button Content="Taramayı Başlat" Command="{Binding StartScanCommand}" Margin="0,0,12,0"/>
            <Button Content="İptal"             Command="{Binding CancelScanCommand}"  Margin="0,0,12,0"/>
            <Button Content="Sahte I/O (Delay)" Command="{Binding FakeIoCommand}"/>
        </StackPanel>

        <!-- Segment özetleri -->
        <DataGrid Grid.Row="3" Grid.ColumnSpan="3"
                  ItemsSource="{Binding Chunks}"
                  AutoGenerateColumns="False" IsReadOnly="True" CanUserAddRows="False">
            <DataGrid.Columns>
                <DataGridTextColumn Header="#"           Binding="{Binding ChunkIndex}" Width="SizeToHeader"/>
                <DataGridTextColumn Header="Aralık Baş"  Binding="{Binding Start}"     Width="*"/>
                <DataGridTextColumn Header="Aralık Son"  Binding="{Binding End}"       Width="*"/>
                <DataGridTextColumn Header="Asal Sayısı" Binding="{Binding Count}"     Width="*"/>
                <DataGridTextColumn Header="Son Asal"    Binding="{Binding LastPrime}" Width="*"/>
            </DataGrid.Columns>
        </DataGrid>

        <!-- Alt satır: ilerleme ve özet -->
        <StackPanel Grid.Row="4" Grid.ColumnSpan="3" Orientation="Horizontal" VerticalAlignment="Center" Margin="0,12,0,0">
            <!-- ENİ 150 -->
            <ProgressBar Width="150" Height="18" Minimum="0" Maximum="100" Value="{Binding ProgressValue}"/>
            <TextBlock Text="{Binding ProgressValue, StringFormat={}{0}%}" VerticalAlignment="Center" Margin="12,0,0,0"/>
            <TextBlock Text="{Binding StatusText}" Margin="12,0,0,0" VerticalAlignment="Center"/>
            <TextBlock Text="{Binding TotalPrimeCount, StringFormat=  | Toplam Asal: {0:n0}}" Margin="12,0,0,0" VerticalAlignment="Center"/>
            <TextBlock Text="{Binding LastPrime, StringFormat=  | Son Asal: {0:n0}}" Margin="12,0,0,0" VerticalAlignment="Center"/>
            <Button Content="Asal Ara" Margin="12,0,0,0" Click="OpenSearch_Click"
                    ToolTip="Arama penceresini aç"/>
        </StackPanel>
    </Grid>
</Window>
